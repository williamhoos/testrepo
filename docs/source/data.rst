.. _Data perspective:

================
Data perspective 
================

As indicated in the :ref:`Overview` discussion respecting :ref:`Data`, this section describes how PEER presently handles data from the point that it is initially entered into the system by a user, proxy or administrator, to the point that that data is either viewable onscreen or appears in an exported file or document, or is taken into account in any calculation of reported results. 

Where not self-descriptive, this section includes an explanation of each function and/or subroutine thatâ€™s involved in this process, including its range of input and output values, any associated program variables and constants, and an explanation for how these are used by the application in handling or manipulating data; and 


.. _Architecture

Achitecture
***********

The following illustration summarizes the overall architecture of the system with respect to data in/data out, including links to which pages, views or fields of the system are used to introduce data elements and the respective flow, transformation and/or retention of such data through the point that the data is consumed (*i.e.*, used by the system, viewed, exported or discarded) according to explicit rules.

.. image:: TBD 
     :alt: Overall system architecture from the perspective of data it contains
|

.. _Existing user verification

PEER survey data
****************

Each of the PEER staging, beta and production environments contains a database entitled "**peer_surveys_published**".  This database is generally the same in all three environments, although the table structures and fields contained inside certain tables may be slightly different depending on development work that is taking place at the time, and the progress of migrating that work from staging into the beta, and production environments.  

Survey data collected through PEER is contained in a table therein entitled "**Data**", which as of October 2016, stores participant responses to all PEER questions, and comprises approximately 106.5 MB in beta, and ___ MB in production.  An image of the Data table is shown below:

.. image:: https://s3.amazonaws.com/peer-downloads/images/TechDocs/PEER+survey+data+table.png
     :alt: PEER survey data table    
     
This table in PEER is generated by the following SQL instruction::

 CREATE TABLE `data` (
 `id` BIGINT(20) UNSIGNED NOT NULL AUTO_INCREMENT,
 `survey_id` BIGINT(20) UNSIGNED NOT NULL DEFAULT '0',
 `session_id` BIGINT(32) UNSIGNED NOT NULL DEFAULT '0',
 `date_added` DATETIME NULL DEFAULT NULL,
 `widget_id` VARCHAR(50) NULL DEFAULT NULL,
 `user_id` BIGINT(20) NULL DEFAULT NULL,
 `variable_date` DATE NULL DEFAULT NULL,
 `question_id` BIGINT(20) UNSIGNED NULL DEFAULT NULL,
 `variable_value` VARCHAR(2000) NULL DEFAULT NULL,
 `response_value` VARCHAR(2000) NULL DEFAULT NULL,
 `unit_of_measure` BIGINT(20) UNSIGNED NULL DEFAULT NULL,
 `group_id` BIGINT(20) UNSIGNED NULL DEFAULT NULL,
 `segment_id` INT(11) NOT NULL,
 `skipped` TINYINT(2) UNSIGNED NULL DEFAULT '0',
 `is_dynamic` TINYINT(3) UNSIGNED NULL DEFAULT '0',
 `instance_id` INT(11) NOT NULL,
 `dynamic_question_id` INT(11) NOT NULL,
 `proxy_user_id` INT(11) NOT NULL,
 PRIMARY KEY (`id`),
 INDEX `Index 2` (`survey_id`, `session_id`, `group_id`, `question_id`, `widget_id`, `user_id`, `date_added`, `variable_date`)
 )
 COLLATE='utf8_general_ci'
 ENGINE=InnoDB
 AUTO_INCREMENT=2042996
 ;

This instruction generates the following table:




Slider question anomaly... reported in Pivotal Tracker as *https://www.pivotaltracker.com/story/show/131929961*
